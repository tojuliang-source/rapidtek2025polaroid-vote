<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rapidtekã€Œä¸€ç¬ãƒ»è·å ´ã€æ‹ç«‹å¾—æ”å½±æ´»å‹•ï½œæŠ•ç¥¨ç³»çµ±</title>
  <style>
    :root{
      --brand:#0b72ff; --brand-600:#085ad1; --bg:#f7f8fa; --surface:#ffffff; --text:#1d2129; --muted:#667085;
    }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", sans-serif;}
    a{color:var(--brand);text-decoration:none}
    .container{max-width:1060px;margin:0 auto;padding:24px}
    header{display:flex;align-items:center;gap:12px;padding:16px 0}
    header img.logo{width:40px;height:40px;object-fit:contain}
    h1{font-size:22px;margin:0}
    .card{background:var(--surface);border:1px solid #e5e7eb;border-radius:14px;box-shadow:0 1px 2px rgba(16,24,40,.06);}
    .card .content{padding:20px}

    /* ç¥¨æ•¸æ¢èˆ‡ç‹€æ…‹ */
    .status{display:flex;justify-content:space-between;align-items:center;gap:12px;margin:8px 0 16px}
    .status .remaining{font-weight:600}
    .status .logout{color:#ef4444}

    /* åœ–ç‰‡ç¶²æ ¼ */
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    @media (max-width:900px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:600px){.grid{grid-template-columns:1fr}}
    .item{border:1px solid #e5e7eb;border-radius:12px;overflow:hidden;background:#fff;display:flex;flex-direction:column}

    /* ç›´å¼ç…§ç‰‡ç¶­æŒåŸå½¢ç‹€ï¼Œé¿å…è£åˆ‡ */
    .item img.photo{width:100%;height:auto;object-fit:contain;background:#00000010}

    .item .meta{display:flex;justify-content:space-between;align-items:center;padding:10px 12px}
    .item .title{font-size:14px;color:var(--text);font-weight:600}
    .item .actions{display:flex;gap:8px}
    .btn{padding:8px 12px;border-radius:10px;border:1px solid #e5e7eb;background:#fff;color:#111827;cursor:pointer}
    .btn-primary{background:var(--brand);border-color:var(--brand);color:#fff}
    .btn-primary:disabled{background:#9dbbf9;border-color:#9dbbf9;color:#fff;cursor:not-allowed}

    /* éš±è—å¾—ç¥¨æ•¸ï¼ˆåƒ…å‰ç«¯è¦–è¦ºï¼‰*/
    .vote-count, .votes, .badge-votes, .count-votes, .item-votes, .ranking-votes {display:none !important}

    /* ç†±é–€å€å¡Šï¼ˆä¸é¡¯ç¤ºç¥¨æ•¸å­—æ¨£ï¼‰*/
    .section-title{font-weight:700;margin:8px 0 12px}

    /* æŠ•ç¥¨å½ˆçª— */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.38);display:none;align-items:center;justify-content:center}
    .modal .dialog{width:min(520px,92vw);background:#fff;border-radius:14px;border:1px solid #e5e7eb}
    .modal .dialog .content{padding:18px}

    .admin{margin-top:16px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img class="logo" src="logo.png" alt="Rapidtek" />
      <h1>ã€Œä¸€ç¬ãƒ»è·å ´ã€é³æ´‹æ‹ç«‹å¾—æ”å½±æ´»å‹•ï½œæŠ•ç¥¨ç³»çµ±</h1>
    </header>

    <section class="card">
      <div class="content">
        <div class="status">
          <div class="remaining">å‰©é¤˜ç¥¨æ•¸ï¼š<span id="remaining">5</span> / <span id="total">5</span></div>
          <button id="logout" class="btn">ç™»å‡º</button>
        </div>

        <div class="section-title">ğŸ”¥ ç†±é–€å‰ä¸‰å</div>
        <!-- ä¸é¡¯ç¤ºç¥¨æ•¸ï¼Œåƒ…é¡¯ç¤ºç¸®åœ– -->
        <div class="grid" id="hotGrid"></div>

        <div class="section-title">å…¨éƒ¨ä½œå“</div>
        <div class="grid" id="allGrid"></div>

        <div style="margin-top:12px;display:flex;gap:8px">
          <button id="confirm" class="btn btn-primary" disabled>ç¢ºèªé€å‡ºæŠ•ç¥¨</button>
          <div id="selectedHint" class="muted" style="color:var(--muted)">å·²é¸æ“‡ï¼š<span id="selectedCount">0</span></div>
        </div>
      </div>
    </section>

    <section class="admin card">
      <div class="content">
        <div class="section-title">ğŸ”§ ç®¡ç†å“¡å¾Œå°</div>
        <div style="display:flex;gap:8px;align-items:center">
          <input id="resetEmp" class="btn" placeholder="è¼¸å…¥å“¡å·¥å·¥è™Ÿ" style="flex:1" />
          <button id="resetBtn" class="btn">é‡ç½®æŠ•ç¥¨</button>
          <a class="btn" href="https://docs.google.com/spreadsheets/d/1MgguT6wubGYgMj2kWMCosgrd2Fodof1fbbJQrcX2DpM/edit" target="_blank">ğŸ“Š é–‹å•Ÿ Google Sheets å¾Œå°</a>
        </div>
      </div>
    </section>
  </div>

  <!-- æŠ•ç¥¨ç¢ºèªå½ˆçª— -->
  <div id="confirmModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
    <div class="dialog">
      <div class="content">
        <h3 id="confirmTitle" style="margin-top:0">ç¢ºèªæŠ•ç¥¨</h3>
        <p>æ‚¨ç¢ºå®šè¦å°‡ç¥¨æŠ•çµ¦é€™äº›ä½œå“å—ï¼ŸæŠ•ç¥¨å¾Œå°‡ç„¡æ³•æ›´æ”¹ã€‚</p>
        <div style="display:flex;gap:8px;justify-content:flex-end">
          <button id="cancelConfirm" class="btn">å–æ¶ˆ</button>
          <button id="doConfirm" class="btn btn-primary">ç¢ºèªé€å‡º</button>
        </div>
      </div>
    </div>
  </div>

  <!-- æˆåŠŸå½ˆçª— -->
  <div id="successModal" class="modal" role="alertdialog" aria-modal="true">
    <div class="dialog">
      <div class="content">
        <h3 style="margin-top:0">æŠ•ç¥¨æˆåŠŸï¼</h3>
        <p>æ„Ÿè¬æ‚¨çš„åƒèˆ‡ï¼Œæ‚¨çš„æŠ•ç¥¨å·²æˆåŠŸé€å‡ºã€‚</p>
        <div style="display:flex;justify-content:flex-end"><button id="successOk" class="btn btn-primary">ç¢ºèª</button></div>
      </div>
    </div>
  </div>

  <script>
    // å‰ç«¯è¨­å®šï¼šå…è¨±è‡ªæŠ•èˆ‡ 5 ç¥¨ä¸Šé™
    const TOTAL_VOTES_LIMIT = 5; // é¡¯ç¤ºèˆ‡å‰ç«¯é™åˆ¶ç”¨é€”ï¼ˆå¾Œç«¯ä»éœ€æ ¡é©—ï¼‰
    const state = {
      remaining: TOTAL_VOTES_LIMIT,
      selected: new Set(),
      currentUserId: 'EMP001',
    };

    // æ¨¡æ“¬ä½œå“è³‡æ–™ï¼ˆå«ä½œè€…ï¼Œå…è¨±è‡ªæŠ•ï¼‰
    const works = [
      {id:'W01', title:'A-ä¸€æ¨“å¤§å»³', authorId:'EMP001', img:'sample-portrait.jpg'}, // è‡ªå·±çš„ä½œå“å¯æŠ•
      {id:'W02', title:'B-ç ”ç™¼å¯¦é©—å®¤', authorId:'EMP002', img:'sample-landscape.jpg'},
      {id:'W03', title:'C-ç”¢ç·šå´æ‹', authorId:'EMP003', img:'sample-portrait2.jpg'},
      {id:'W04', title:'D-æœƒè­°å®¤', authorId:'EMP004', img:'sample-landscape2.jpg'},
      {id:'W05', title:'E-èµ°å»Šå…‰å½±', authorId:'EMP005', img:'sample-portrait3.jpg'},
      {id:'W06', title:'F-å±‹é ‚æ—¥è½', authorId:'EMP006', img:'sample-landscape3.jpg'}
    ];

    const hotGrid = document.getElementById('hotGrid');
    const allGrid = document.getElementById('allGrid');

    function renderItem(w){
      const el = document.createElement('div');
      el.className = 'item';
      el.innerHTML = `
        <img class="photo" src="${w.img}" alt="${w.title}" />
        <div class="meta">
          <div class="title">${w.title}</div>
          <div class="actions">
            <button class="btn btn-primary" data-id="${w.id}">æŠ•ç¥¨</button>
          </div>
        </div>
      `;
      // å…è¨±è‡ªæŠ•ï¼šä¸åš authorId === currentUserId çš„é˜»æ“‹
      const btn = el.querySelector('button');
      btn.addEventListener('click', () => {
        if(state.remaining <= 0){
          btn.disabled = true; return;
        }
        if(!state.selected.has(w.id)){
          state.selected.add(w.id);
          state.remaining -= 1;
        }else{ // å†æ¬¡é»æ“Šå¯å–æ¶ˆé¸å–ï¼ˆé€å‡ºå‰å¯æ›´æ”¹ï¼‰
          state.selected.delete(w.id);
          state.remaining += 1;
        }
        updateUI();
      });
      return el;
    }

    function updateUI(){
      document.getElementById('remaining').textContent = state.remaining;
      document.getElementById('total').textContent = TOTAL_VOTES_LIMIT;
      document.getElementById('selectedCount').textContent = state.selected.size;
      document.getElementById('confirm').disabled = state.selected.size === 0;
    }

    // æ¸²æŸ“ç†±é–€ï¼ˆå‰ 3 å€‹ç¤ºæ„ï¼‰èˆ‡å…¨éƒ¨
    works.slice(0,3).forEach(w=> hotGrid.appendChild(renderItem(w)));
    works.forEach(w=> allGrid.appendChild(renderItem(w)));
    updateUI();

    // ç¢ºèªå½ˆçª—æµç¨‹
    const confirmModal = document.getElementById('confirmModal');
    const successModal = document.getElementById('successModal');
    document.getElementById('confirm').addEventListener('click',()=>{confirmModal.style.display='flex'});
    document.getElementById('cancelConfirm').addEventListener('click',()=>{confirmModal.style.display='none'});
    document.getElementById('doConfirm').addEventListener('click',()=>{
      // TODO: åœ¨æ­¤å‘¼å«å¾Œç«¯ï¼ˆGoogle Apps Scriptï¼‰å¯«å…¥æŠ•ç¥¨çµæœã€‚
      // å‚™è¨»ï¼šè«‹ç¢ºä¿å¾Œç«¯å…è¨±è‡ªæŠ•ï¼Œä¸¦æŠŠæ¯äººä¸Šé™è¨­ç‚º 5ã€‚
      confirmModal.style.display='none';
      successModal.style.display='flex';
    });
    document.getElementById('successOk').addEventListener('click',()=>{successModal.style.display='none'});

    // ç™»å‡ºï¼ˆåƒ…ç¤ºæ„ï¼‰
    document.getElementById('logout').addEventListener('click',()=>{
      alert('å·²ç™»å‡ºï¼ˆç¤ºæ„ï¼‰');
    });
  </script>
</body>
</html>
